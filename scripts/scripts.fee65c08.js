"use strict";angular.module("weatherappNgApp",["ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",resolve:{citiesData:["CityService","cities","$q",function(a,b,c){var d=$.map(b.cities(),function(b){return a.getWeatherData(b)});return c.all(d).then(function(a){return $("body").removeClass().addClass("show-cities-list"),a})}]}}).when("/add",{templateUrl:"views/add.html",controller:"AddCtrl"}).when("/edit",{templateUrl:"views/edit.html",controller:"EditCtrl"}).when("/city/:cityId",{templateUrl:"views/city.html",controller:"CityCtrl",resolve:{cityData:["CityService","cities","$route","$location","conditionClassnameFilter",function(a,b,c,d,e){var f=b.city(c.current.params.cityId);return f||d.path("/"),a.getWeatherData(f).then(function(a){return $("body").removeClass().addClass("show-selected-city"),$("body").removeClass("is-cloudy").removeClass("is-night").removeClass("is-day").addClass(e(a.weatherData)),a})}]}}).otherwise({redirectTo:"/"})}]),angular.module("weatherappNgApp").controller("MainCtrl",["$scope","useUSUnits","citiesData",function(a,b,c){a.cities=c,a.useUSUnits=b,a.sinceLastUpdated=function(a){return(new Date).getTime()-a}}]),angular.module("weatherappNgApp").controller("AddCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("weatherappNgApp").controller("EditCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("weatherappNgApp").controller("CityCtrl",["$scope","localDateFilter","$window","cityData","useUSUnits",function(a,b,c,d,e){a.city=d,a.localDateFilter=b,a.Math=c.Math,a.useUSUnits=e,a.relativeDate=function(a){var b=Math.round((a.getTime()-(new Date).getTime())/864e5),c="Today";return 0>b?c="Yesterday":b>0&&(c="Tomorrow"),c}}]),angular.module("weatherappNgApp").filter("conditionClassname",function(){return function(a){var b="";if(a){var c=a.hourly.data[0];b+=c.time>=a.daily.data[0].sunriseTime&&c.time<=a.daily.data[0].sunsetTime?"is-day ":"is-night ",(-1!==c.icon.indexOf("cloudy")||c.cloudCover>.2)&&(b+="is-cloudy ")}return b}}),angular.module("weatherappNgApp").filter("formatTemperature",["useUSUnits",function(a){return function(b){var c=a.value;return Math.round(c?9*b/5+32:b)+"Ëš"}}]),angular.module("weatherappNgApp").filter("formatTime",function(){return function(a,b){var c=a.getHours(),d="AM";if(c>=12&&(c>12&&(c-=12),d="PM"),0===c&&(c=12),b){var e=a.getMinutes();return 10>e&&(e="0"+e),c+":"+e+" "+d}return c+" "+d}}),angular.module("weatherappNgApp").filter("localDate",function(){return function(a,b,c){c=c?c:0;var d=new Date(1e3*a+c),e=new Date(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate(),d.getUTCHours(),d.getUTCMinutes());return e.setHours(e.getHours()+b),e}}),angular.module("weatherappNgApp").filter("weekDayForDate",function(){return function(a){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"][a.getDay()]}}),angular.module("weatherappNgApp").filter("formatPercentage",function(){return function(a){return Math.round(100*a)+"%"}}),angular.module("weatherappNgApp").filter("formatWind",["useUSUnits","formatBearingFilter",function(a,b){return function(c){var d=a.value,e=(d?.621371*c.windSpeed:c.windSpeed).toFixed(1);return e+(d?" mph":" kph")+" "+b(new Date(c.windBearing),!0)}}]),angular.module("weatherappNgApp").filter("formatPrecipitation",["useUSUnits",function(a){return function(b){var c=a.value;if(0===b)return"--";var d=c?(.0393701*b).toFixed(2):b;return d+(c?" in":" mm")}}]),angular.module("weatherappNgApp").filter("formatPressureFromHPA",["useUSUnits",function(a){return function(b){var c=a.value;return c?(.000295299830714*b*100).toFixed(2)+" in":b.toFixed(2)+" hPa"}}]),angular.module("weatherappNgApp").filter("formatVisibility",["useUSUnits",function(a){return function(b){var c=a.value,d=(c?.621371*b:b).toFixed(1);return d+(c?" mi":" km")}}]),angular.module("weatherappNgApp").constant("currentLocationKey","currentlocation"),angular.module("weatherappNgApp").constant("dataRefreshInterval",6e5),angular.module("weatherappNgApp").constant("timeUpdateInterval",5e3),angular.module("weatherappNgApp").constant("weatherAPIKey","e157d0906b1d14f719ca4d1ad2a05325"),angular.module("weatherappNgApp").constant("weatherAPIBaseURL","https://api.forecast.io/forecast/"),angular.module("weatherappNgApp").filter("formatBearing",function(){return function(a){var b=["NE","E","SE","S","SW","W","NW","N"],c=a-22.5;return 0>c&&(c+=360),c=parseInt(c/45),b[c]}}),angular.module("weatherappNgApp").factory("useUSUnits",function(){var a={value:!0};return a.flip=function(){a.value=!a.value},a}),angular.module("weatherappNgApp").filter("bindField",function(){return function(a){return a}}),angular.module("weatherappNgApp").factory("CityService",["$http","$q","weatherAPIBaseURL","weatherAPIKey","dataRefreshInterval",function(a,b,c,d,e){return{getWeatherData:function(f){return!f||(new Date).getTime()-e<f.lastUpdated?b.when(f):a({method:"jsonp",url:c+d+"/"+f.lat+","+f.lng,params:{units:"si",callback:"JSON_CALLBACK"}}).then(function(a){return f.weatherData=a.data,f.lastUpdated=(new Date).getTime(),f})}}}]),angular.module("weatherappNgApp").factory("cities",function(){var a=[{id:"sanjose",name:"San Jose",lat:37.3382082,lng:-121.88632860000001,lastUpdated:-1,weatherData:null},{id:"sydney",name:"Sydney",lat:-33.8674869,lng:151.20699020000006,lastUpdated:-1,weatherData:null}];return{cities:function(){return a},city:function(b){for(var c=0;c<a.length;++c)if(a[c].id===b)return a[c];return null}}});